(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3806:(e,t,o)=>{Promise.resolve().then(o.bind(o,6488))},6488:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>a});var l=o(5155),s=o(6294),r=o(2115);let n=e=>{let{id:t,floor:o,moving:s,direction:n,requests:i,setFloor:a,setMoving:d,setRequests:u,setDirection:c}=e;return(0,r.useEffect)(()=>{if(s){let e=i.filter(e=>e.direction===n),t=e.reduce((e,t)=>Math.max(e,t.floor_to),-1/0),o=e.reduce((e,t)=>Math.min(e,t.floor_to),1/0),l=setInterval(()=>{a(e=>"up"===n&&e<t?e+1:"down"===n&&e>o?e-1:(d(!1),c("idle"),u(t=>t.filter(t=>t.floor_to!==e)),e))},1e4);return()=>clearInterval(l)}},[s,n,a,d,i,c,u]),(0,l.jsxs)("div",{className:"flex flex-col items-center gap-4 p-4 border rounded-lg shadow-lg w-64",children:[(0,l.jsxs)("h1",{className:"text-xl font-bold",children:["Elevator ",t]}),(0,l.jsxs)("p",{children:[" ","idle"===n?"Idle...":"Going ".concat(n)]}),(0,l.jsxs)("div",{className:"text-lg",children:["Current Floor: ",o]})]})},i=e=>{let t;do t=Math.floor(10*Math.random())+1;while(t===e);return t},a=()=>{let e=Array.from({length:10},(e,t)=>t+1),{elevator1:t,elevator2:o,elevator3:a,elevator4:d}=(0,r.useContext)(s.M),[u,c]=(0,r.useState)([]),f=(0,r.useDeferredValue)(u),g=e=>{let l=[t,o,a,d],s=i(e),r=s>e?"down":"up";console.log("Request:",{floor_from:s,floor_to:e,direction:r});let n=l.filter(e=>e.direction===r&&("up"===r?e.floor<=s:e.floor>=s)).sort((e,t)=>Math.abs(e.floor-s)-Math.abs(t.floor-s));if(n.length>0){let t=n[0];t.setRequests(t=>[...t,{id:Date.now(),direction:r,status:"pending",floor_from:s,floor_to:e}]),console.log("Assigned to a moving elevator",t.id,{floor_from:s,floor_to:e,direction:r});return}let u=l.find(e=>"idle"===e.direction);if(u){if("down"===r&&u.floor<s){u.setRequests(e=>[...e,{id:Date.now(),direction:"up",status:"pending",floor_from:u.floor,floor_to:s}]),u.setDirection("up"),u.setMoving(!0),console.log("Idle elevator ".concat(u.id," moving UP first to pick up"),u.floor,"->",s),setTimeout(()=>{u.setDirection("down"),u.setRequests(t=>[...t,{id:Date.now(),direction:"down",status:"pending",floor_from:s,floor_to:e}]),u.setMoving(!0),console.log("Idle elevator ".concat(u.id," now moving DOWN"),s,"->",e)},3e3*Math.abs(s-u.floor));return}u.setDirection(r),u.setRequests(t=>[...t,{id:Date.now(),direction:r,status:"pending",floor_from:s,floor_to:e}]),u.setMoving(!0),console.log("Assigned to an idle elevator",u.id,{floor_from:s,floor_to:e,direction:r});return}console.log("No available elevator for request. Pass it into the queue"),setTimeout(()=>c(e=>[...e,s]),12e3)};return(0,r.useEffect)(()=>{console.log("SERVICE INITIALIZED ===> TRIGGERING THE QUEUE");let e=setInterval(()=>{let e=Math.floor(10*Math.random())+1;c(t=>[...t,e])},12e3);return()=>clearInterval(e)},[]),(0,r.useEffect)(()=>{f.length>0&&(g(f[0]),c(e=>e.slice(1)))},[f]),(0,l.jsxs)("div",{className:"flex gap-8",children:[(0,l.jsxs)("div",{className:"flex gap-4 flex-col",children:[(0,l.jsx)(n,{...t}),(0,l.jsx)(n,{...o}),(0,l.jsx)(n,{...a}),(0,l.jsx)(n,{...d})]}),(0,l.jsx)("div",{className:"flex gap-4 flex-col-reverse",children:e.map(e=>(0,l.jsxs)("button",{onClick:()=>g(e),className:"px-4 py-2 bg-blue-500 text-white rounded-lg shadow-md hover:bg-blue-600 transition",children:["Floor ",e]},e))})]})}},6294:(e,t,o)=>{"use strict";o.d(t,{M:()=>n,u:()=>i});var l=o(5155),s=o(2115);let r=e=>{let[t,o]=(0,s.useState)(1),[l,r]=(0,s.useState)(!1),[n,i]=(0,s.useState)("idle"),[a,d]=(0,s.useState)([]);return{id:e,direction:n,moving:l,floor:t,requests:a,setRequests:d,setDirection:i,setFloor:o,setMoving:r}},n=(0,s.createContext)({}),i=e=>{let{children:t}=e,o=r(1),s=r(2),i=r(3),a=r(4);return(0,l.jsx)(n.Provider,{value:{elevator1:o,elevator2:s,elevator3:i,elevator4:a},children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(3806)),_N_E=e.O()}]);